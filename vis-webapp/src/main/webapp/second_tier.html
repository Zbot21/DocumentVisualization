<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Second Tier</title>
    <link rel="stylesheet" type="text/css" href="style/style.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="js/secondTierGraph.js"></script>
    <script>
        $(document).ready(function(){
            var chart = forceChart();
            var docId = localStorage.getItem("docId");
            var queryString = "query";
            var queries = [];
            var queryNum = 1;
            while(null != localStorage.getItem(queryString+queryNum)){
                queries.push(localStorage.getItem(queryString+queryNum));
                queryNum++;
            }

            if(queries.length != 0){
                var jsonRequestString = "second_tier?docId="+docId;
                var num = 1;
                for (var qNum in queries){
                    var query = queries[qNum];
                    jsonRequestString += "&" + queryString + num + "=" + query;
                    num++;
                }
                d3.json(jsonRequestString, function(error, data){
                    if(error) throw error;
                    d3.select("#main_second").datum(data).call(chart);
                })

            }else{
                console.log("NO QUERIES!");
            }
        })
    </script>
</head>
<body>
<div id="main_second"></div>
</body>
</html>